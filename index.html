<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Interactive Map</title><style>html,body{margin:0;padding:0;height:100%;overflow:hidden;background:black}#scroll-container{width:100vw;height:100vh;height:100svh;overflow-x:auto;overflow-y:hidden}#main-svg{height:100%;width:auto;display:block;transition:opacity .3s ease-out}.image-mapper-shape{fill:transparent;stroke:transparent;stroke-width:2px;transform-origin:center center;transition:filter .3s ease,stroke-width .3s ease;cursor:pointer}.q{stroke:red}.v{stroke:blue}.i{stroke:white}.a{stroke:purple}.l{stroke:yellow}.s{stroke:green}.zoom-part{pointer-events:none}#loading-overlay{position:fixed;inset:0;background:black;display:flex;align-items:center;justify-content:center;z-index:9999;transition:opacity .3s ease-out}#loading-content{text-align:center}#loading-text{color:white;font-size:24px;font-family:Arial,Helvetica,sans-serif}#loading-overlay,#loading-text{pointer-events:none}#loader-lights{display:flex;justify-content:center;gap:10px;margin-bottom:20px}.light-bulb{width:20px;height:20px;border-radius:50%;background-color:#333;border:2px solid #555;box-shadow:0 0 5px rgba(0,0,0,.5);transition:all .5s ease-in-out}.light-bulb.on{background-color:#ffcc00;box-shadow:0 0 10px #ffcc00,0 0 20px #ffcc00,0 0 30px #ff9900,0 0 40px #ff6600;border-color:#ff9900}#js-toggle-container{position:fixed;right:20px;z-index:10000;display:flex;flex-direction:column;align-items:flex-end;gap:10px;color:white;font-family:'Arial',sans-serif;background-color:rgba(0,0,0,.5);padding:8px 12px;border-radius:5px;transition:top .3s ease-in-out,bottom .3s ease-in-out}#js-toggle-container.top{top:20px;bottom:auto}#js-toggle-container.bottom{bottom:20px;top:auto}#search-container{position:relative;display:flex;align-items:center;margin-bottom:5px;width:200px}#search-input{padding:5px 10px;padding-left:30px;border:none;border-radius:3px;width:100%;box-sizing:border-box}#search-icon{position:absolute;left:10px;top:50%;transform:translateY(-50%);color:#333;pointer-events:none}#move-toggle{font-size:20px;cursor:pointer;user-select:none;opacity:.7;transition:opacity .2s}#move-toggle:hover{opacity:1}.switch{position:relative;display:inline-block;width:45px;height:25px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider:before{position:absolute;content:"";height:17px;width:17px;left:4px;bottom:4px;background-color:white;transition:.4s}input:checked+.slider{background-color:#2196F3}input:focus+.slider{box-shadow:0 0 1px #2196F3}input:checked+.slider:before{transform:translateX(20px)}.slider.round{border-radius:25px}.slider.round:before{border-radius:50%}#splash-image{max-width:85%;height:auto;display:block;margin:0 auto;margin-bottom:30px;border-radius:8px}#loading-content h1{color:#ffcc00;margin-top:5px;margin-bottom:5px}#main-svg{opacity:0}.rect-label{opacity:1;transition:opacity .2s ease}</style><div id="js-toggle-container" class="top"><div id="search-container"><input type="text" id="search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ÿ®ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÑŸÅ (e.g., micro)"><span id="search-icon">üîç</span></div><span id="move-toggle" title="Move Toggle Position">‚ÜïÔ∏è</span><label class="switch"><input type="checkbox" id="js-toggle" checked><span class="slider round"></span></label><span id="toggle-label">Interaction Enabled</span></div><div id="loading-overlay"><div id="loading-content"><img id="splash-image" src="image/o.webp" alt="Merit University Level 2 Group B Section 15" /><h1 style="color:#ffcc00;margin-bottom:5px;margin-top:15px">Interactive College Map</h1><div id="loader-lights"><div class="light-bulb" id="bulb-1"></div><div class="light-bulb" id="bulb-2"></div><div class="light-bulb" id="bulb-3"></div><div class="light-bulb" id="bulb-4"></div></div><p id="loading-text">Preparing the environment...</p></div></div><div id="scroll-container"><svg id="main-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMinYMin meet"><defs></defs><g id="fixed-weeks-container"></g></svg></div><script>async function loadFixedWeeksContent(){try{const response=await fetch('fixed-weeks-content.txt');if(!response.ok)throw new Error('Failed to load fixed-weeks-content.txt');const svgContent=await response.text();const mainSvg=document.getElementById('main-svg');mainSvg.querySelector('defs').insertAdjacentHTML('afterend',svgContent)}catch(error){console.error('Error loading SVG content:',error);document.getElementById('loading-text').textContent='Error loading map content.'}}window.onload=async function(){await loadFixedWeeksContent();const mainSvg=document.getElementById('main-svg'),scrollContainer=document.getElementById('scroll-container'),clipDefs=mainSvg.querySelector('defs'),loadingOverlay=document.getElementById('loading-overlay'),loadingText=document.getElementById('loading-text'),jsToggle=document.getElementById('js-toggle'),searchInput=document.getElementById('search-input');let interactionEnabled=jsToggle.checked;const isTouchDevice=window.matchMedia('(hover: none)').matches;const TAP_THRESHOLD_MS=300;const activeState={rect:null,zoomPart:null,zoomText:null,baseText:null,animationId:null,clipPathId:null,initialScrollLeft:0,isScrolling:false,touchStartTime:0};function debounce(func,delay){let timeoutId;return function(){const context=this;const args=arguments;clearTimeout(timeoutId);timeoutId=setTimeout(()=>func.apply(context,args),delay)}}function updateDynamicSizes(){const images=mainSvg.querySelectorAll('image');if(!images.length)return;const firstImage=images[0];const imageWidth=parseFloat(firstImage.getAttribute('width'))||1024;const imageHeight=parseFloat(firstImage.getAttribute('height'))||2454;const totalWidth=images.length*imageWidth;mainSvg.setAttribute('viewBox',`0 0 ${totalWidth} ${imageHeight}`);window.MAX_SCROLL_LEFT=totalWidth-window.innerWidth}updateDynamicSizes();const debouncedCleanupHover=debounce(function(){if(!interactionEnabled||!activeState.rect)return;if(activeState.rect){cleanupHover()}},50);scrollContainer.addEventListener('scroll',function(){if(this.scrollLeft>window.MAX_SCROLL_LEFT){this.scrollLeft=window.MAX_SCROLL_LEFT}if(!interactionEnabled)return;if(activeState.rect&&!isTouchDevice){debouncedCleanupHover()}if(activeState.rect&&isTouchDevice){if(Math.abs(this.scrollLeft-activeState.initialScrollLeft)>5){activeState.isScrolling=true;cleanupHover()}}});function getCumulativeTranslate(element){let x=0,y=0;let current=element;while(current&&current.tagName!=='svg'){const transformAttr=current.getAttribute('transform');if(transformAttr){const match=transformAttr.match(/translate\(\s*([\d.-]+)[ ,]+([\d.-]+)\s*\)/);if(match){x+=parseFloat(match[1]);y+=parseFloat(match[2])}}current=current.parentNode}return{x,y}}function getGroupImage(element){let current=element;while(current&&current.tagName!=='svg'){if(current.tagName==='g'){const images=[...current.children].filter(c=>c.tagName==='image');if(images.length){const baseImage=images[0];return{src:baseImage.getAttribute('data-src')||baseImage.getAttribute('href'),width:parseFloat(baseImage.getAttribute('width')),height:parseFloat(baseImage.getAttribute('height')),group:current}}}current=current.parentNode}return null}function cleanupHover(){if(!activeState.rect)return;const rectToClean=activeState.rect;const clipPathIdToClean=activeState.clipPathId;const zoomPartToClean=activeState.zoomPart;const zoomTextToClean=activeState.zoomText;const baseTextToClean=activeState.baseText;const animationIdToClean=activeState.animationId;if(animationIdToClean)clearInterval(animationIdToClean);rectToClean.style.filter='none';if(zoomPartToClean)zoomPartToClean.style.filter='none';if(zoomTextToClean)zoomTextToClean.style.filter='none';rectToClean.style.transform='scale(1)';rectToClean.style.strokeWidth='2px';if(zoomPartToClean)zoomPartToClean.style.transform='scale(1)';if(baseTextToClean){baseTextToClean.style.opacity='1'}if(zoomTextToClean){zoomTextToClean.style.opacity='0'}if(zoomPartToClean)zoomPartToClean.remove();const currentClip=document.getElementById(clipPathIdToClean);if(currentClip)currentClip.remove();if(zoomTextToClean)zoomTextToClean.remove();Object.assign(activeState,{rect:null,zoomPart:null,zoomText:null,baseText:null,animationId:null,clipPathId:null,initialScrollLeft:0,isScrolling:false,touchStartTime:0})}function startHover(){if(!interactionEnabled)return;const rect=this;if(activeState.rect===rect)return;cleanupHover();activeState.rect=rect;const scale=1.1;const x=parseFloat(rect.getAttribute('x'));const y=parseFloat(rect.getAttribute('y'));const width=parseFloat(rect.getAttribute('width'));const height=parseFloat(rect.getAttribute('height'));const cumulative=getCumulativeTranslate(rect);const absoluteX=x+cumulative.x;const absoluteY=y+cumulative.y;const centerX=absoluteX+width/2;const centerY=absoluteY+height/2;rect.style.transformOrigin=`${x+width/2}px ${y+height/2}px`;rect.style.transform=`scale(${scale})`;rect.style.strokeWidth='4px';const imageData=getGroupImage(rect);let zoomPartElement=null;if(imageData){const i=rect.getAttribute('data-index')||Date.now();const clipPathId=`clip-${i}-${Date.now()}`;activeState.clipPathId=clipPathId;const clip=document.createElementNS('http://www.w3.org/2000/svg','clipPath');clip.setAttribute('id',clipPathId);const clipRect=document.createElementNS('http://www.w3.org/2000/svg','rect');clipRect.setAttribute('x',absoluteX);clipRect.setAttribute('y',absoluteY);clipRect.setAttribute('width',width);clipRect.setAttribute('height',height);clipDefs.appendChild(clip).appendChild(clipRect);const zoomPart=document.createElementNS('http://www.w3.org/2000/svg','image');zoomPart.setAttribute('href',imageData.src);zoomPart.setAttribute('width',imageData.width);zoomPart.setAttribute('height',imageData.height);zoomPart.setAttribute('class','zoom-part');zoomPart.setAttribute('clip-path',`url(#${clipPathId})`);const groupTransform=imageData.group.getAttribute('transform');const match=groupTransform?groupTransform.match(/translate\(([\d.-]+),([\d.-]+)\)/):null;const groupX=match?parseFloat(match[1]):0;const groupY=match?parseFloat(match[2]):0;zoomPart.setAttribute('x',groupX);zoomPart.setAttribute('y',groupY);zoomPart.style.opacity=0;mainSvg.appendChild(zoomPart);activeState.zoomPart=zoomPart;zoomPart.style.transformOrigin=`${centerX}px ${centerY}px`;zoomPart.style.transform=`scale(${scale})`;zoomPart.style.opacity=1;zoomPartElement=zoomPart}let baseText=rect.nextElementSibling;if(baseText&&!baseText.matches('text.rect-label')){baseText=null}if(baseText){baseText.style.opacity='0';activeState.baseText=baseText;const zoomText=baseText.cloneNode(true);const baseFont=parseFloat(baseText.style.fontSize);zoomText.style.fontSize=(baseFont*2)+'px';zoomText.style.fill='white';zoomText.style.pointerEvents='none';zoomText.style.userSelect='none';zoomText.style.opacity='1';zoomText.setAttribute('x',absoluteX+width/2);zoomText.setAttribute('y',absoluteY+baseFont*1.5);zoomText.setAttribute('text-anchor','middle');mainSvg.appendChild(zoomText);activeState.zoomText=zoomText}let hue=0;activeState.animationId=setInterval(()=>{hue=(hue+10)%360;const glow=`drop-shadow(0 0 8px hsl(${hue},100%,55%)) drop-shadow(0 0 14px hsl(${(hue+60)%360},100%,60%))`;rect.style.filter=glow;if(zoomPartElement){zoomPartElement.style.filter=glow}if(activeState.zoomText){activeState.zoomText.style.filter=glow}},100)}function stopHover(){if(!interactionEnabled)return;if(activeState.rect===this)cleanupHover()}function handleLinkOpen(event){const href=event.currentTarget.getAttribute('data-href');if(href&&href!=='#'){window.open(href,'_blank');event.preventDefault();event.stopPropagation()}}function attachHover(rect,i){rect.setAttribute('data-index',i);if(!isTouchDevice){function handleMouseOver(){if(interactionEnabled)startHover.call(rect)}function handleMouseOut(){if(interactionEnabled)stopHover.call(rect)}rect.addEventListener('mouseover',handleMouseOver);rect.addEventListener('mouseout',handleMouseOut)}rect.addEventListener('click',handleLinkOpen);rect.addEventListener('touchstart',function(event){if(!interactionEnabled)return;activeState.touchStartTime=Date.now();activeState.initialScrollLeft=scrollContainer.scrollLeft;activeState.isScrolling=false;startHover.call(this)});rect.addEventListener('touchend',function(event){if(!interactionEnabled)return;const timeElapsed=Date.now()-activeState.touchStartTime;if(activeState.isScrolling===false&&timeElapsed<TAP_THRESHOLD_MS){handleLinkOpen(event)}cleanupHover()})}const svgImages=Array.from(mainSvg.querySelectorAll('image'));const rectShapes=Array.from(mainSvg.querySelectorAll('rect.image-mapper-shape'));const rectLabels=Array.from(mainSvg.querySelectorAll('text.rect-label'));const allRectsAndLabels=[...rectShapes,...rectLabels];function filterRects(query){const lowerQuery=query.toLowerCase();allRectsAndLabels.forEach(element=>{let match=false;if(element.tagName==='rect'){const href=element.getAttribute('data-href')||'';if(href.toLowerCase().includes(lowerQuery))match=true}else if(element.tagName==='text'){if(element.textContent.toLowerCase().includes(lowerQuery))match=true}const rectShape=(element.tagName==='rect')?element:element.previousElementSibling;if(rectShape&&rectShape.matches('rect.image-mapper-shape')){const correspondingLabel=rectShape.nextElementSibling;if(query.length>0&&!match){rectShape.style.opacity='0.1';rectShape.style.pointerEvents='none';if(correspondingLabel)correspondingLabel.style.opacity='0.1'}else{rectShape.style.opacity='1';rectShape.style.pointerEvents='auto';if(query.length>0&&match){rectShape.style.filter='drop-shadow(0 0 8px #00FFFF) drop-shadow(0 0 14px #00FFFF)'}else{rectShape.style.filter='none'}}}})}const debouncedFilter=debounce(filterRects,150);searchInput.addEventListener('input',function(){debouncedFilter(this.value)});const urls=svgImages.map(img=>img.getAttribute('data-src')||img.getAttribute('href'));let loadedCount=0;const totalCount=urls.length;const startTime=Date.now();const MINIMUM_DISPLAY_TIME_MS=1000;function updateLoader(){const percent=Math.round((loadedCount/totalCount)*100);if(loadingText)loadingText.textContent=`Preparing the environment...`;if(percent>=25)document.getElementById('bulb-1').classList.add('on');if(percent>=50)document.getElementById('bulb-2').classList.add('on');if(percent>=75)document.getElementById('bulb-3').classList.add('on');if(percent===100)document.getElementById('bulb-4').classList.add('on')}function finishLoading(){if(loadingOverlay){const timeElapsed=Date.now()-startTime;const remainingTime=Math.max(0,MINIMUM_DISPLAY_TIME_MS-timeElapsed);setTimeout(()=>{loadingOverlay.style.opacity=0;setTimeout(()=>{loadingOverlay.style.display='none';mainSvg.style.opacity=1;setTimeout(()=>{scrollContainer.scrollLeft=scrollContainer.scrollWidth;scrollContainer.scrollTo({left:scrollContainer.scrollWidth,behavior:'smooth'})},50)},300)},remainingTime)}}if(urls.length>0){urls.forEach((url,index)=>{const img=new Image();img.onload=img.onerror=()=>{loadedCount++;updateLoader();if(loadedCount===totalCount){finishLoading();svgImages.forEach((svgImg,i)=>{svgImg.setAttribute('href',urls[i])})}};img.src=url})}else{finishLoading()}document.querySelectorAll('rect.image-mapper-shape').forEach(rect=>{const href=rect.getAttribute('data-href')||'';const fileName=href.split('/').pop().split('#')[0]||'';const textContent=fileName;const rectWidth=parseFloat(rect.getAttribute('width'));const rectX=parseFloat(rect.getAttribute('x'));const rectY=parseFloat(rect.getAttribute('y'));const minFont=8;const maxFont=16;const scaleFactor=.12;let fontSize=rectWidth*scaleFactor;fontSize=Math.max(minFont,Math.min(maxFont,fontSize));const text=document.createElementNS('http://www.w3.org/2000/svg','text');text.setAttribute('x',rectX+rectWidth/2);text.setAttribute('y',rectY+fontSize+6);text.setAttribute('text-anchor','middle');text.textContent=textContent;text.style.fontSize=fontSize+'px';text.style.fill='white';text.style.pointerEvents='none';text.setAttribute('class','rect-label');rect.parentNode.insertBefore(text,rect.nextSibling)});document.querySelectorAll('rect.image-mapper-shape').forEach((rect,i)=>{rect.setAttribute('data-processed','true');attachHover(rect,i)});const rootObserver=new MutationObserver(mutations=>{mutations.forEach(mutation=>{mutation.addedNodes.forEach(node=>{if(node.nodeType===1){if(node.matches('rect.image-mapper-shape')&&!node.hasAttribute('data-processed')){attachHover(node,Date.now());node.setAttribute('data-processed','true')}if(node.querySelector){node.querySelectorAll('rect.image-mapper-shape:not([data-processed])').forEach(rect=>{attachHover(rect,Date.now());rect.setAttribute('data-processed','true')})}}})})});rootObserver.observe(mainSvg,{childList:true,subtree:true});jsToggle.addEventListener('change',function(){interactionEnabled=this.checked;const label=document.getElementById('toggle-label');if(interactionEnabled){label.textContent='Interaction Enabled'}else{label.textContent='Interaction Disabled';cleanupHover()}});const moveToggle=document.getElementById('move-toggle');const toggleContainer=document.getElementById('js-toggle-container');moveToggle.addEventListener('click',function(){if(toggleContainer.classList.contains('top')){toggleContainer.classList.remove('top');toggleContainer.classList.add('bottom')}else{toggleContainer.classList.remove('bottom');toggleContainer.classList.add('top')}})}</script>