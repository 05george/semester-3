window.onload=function(){const a=document.getElementById("main-svg"),b=document.getElementById("scroll-container"),c=a.querySelector("defs"),d=document.getElementById("loading-overlay"),e=document.getElementById("loading-text"),f=document.getElementById("js-toggle"),g=document.getElementById("search-input");let h=f.checked;const i=window.matchMedia("(hover: none)").matches,j=300,k={rect:null,zoomPart:null,zoomText:null,baseText:null,animationId:null,clipPathId:null,initialScrollLeft:0,isScrolling:!1,touchStartTime:0};function l(m,n){let o;return function(){const p=this,q=arguments;clearTimeout(o),o=setTimeout(()=>m.apply(p,q),n)}}function m(){const b=a.querySelectorAll("image");if(!b.length)return;const c=b[0],d=parseFloat(c.getAttribute("width"))||1024,e=parseFloat(c.getAttribute("height"))||2454,f=b.length*d;a.setAttribute("viewBox",`0 0 ${f} ${e}`),window.MAX_SCROLL_LEFT=f-window.innerWidth}m();const n=l(function(){if(!h||!k.rect)return;if(k.rect){p()}},50);b.addEventListener("scroll",function(){if(this.scrollLeft>window.MAX_SCROLL_LEFT){this.scrollLeft=window.MAX_SCROLL_LEFT}if(!h)return;if(k.rect&&!i){n()}if(k.rect&&i){if(Math.abs(this.scrollLeft-k.initialScrollLeft)>5){k.isScrolling=!0,p()}}});function o(a){let b=0,c=0,d=a;while(d&&d.tagName!=="svg"){const a=d.getAttribute("transform");if(a){const d=a.match(/translate\(\s*([\d.-]+)[ ,]+([\d.-]+)\s*\)/);if(d){b+=parseFloat(d[1]),c+=parseFloat(d[2])}}d=d.parentNode}return{x:b,y:c}}function q(a){let b=a;while(b&&b.tagName!=="svg"){if(b.tagName==="g"){const a=[...b.children].filter(c=>c.tagName==="image");if(a.length){const b=a[0];return{src:b.getAttribute("data-src")||b.getAttribute("href"),width:parseFloat(b.getAttribute("width")),height:parseFloat(b.getAttribute("height")),group:b}}}b=b.parentNode}return null}function p(){if(!k.rect)return;const a=k.rect,b=k.clipPathId,e=k.zoomPart,f=k.zoomText,g=k.baseText,h=k.animationId;if(h)clearInterval(h);a.style.filter="none",e&&e.style.filter&&(e.style.filter="none"),f&&f.style.filter&&(f.style.filter="none"),a.style.transform="scale(1)",a.style.strokeWidth="2px",e&&e.style.transform&&(e.style.transform="scale(1)"),g&&(g.style.opacity="1"),f&&(f.style.opacity="0"),e&&e.remove();const i=document.getElementById(b);i&&i.remove(),f&&f.remove(),Object.assign(k,{rect:null,zoomPart:null,zoomText:null,baseText:null,animationId:null,clipPathId:null,initialScrollLeft:0,isScrolling:!1,touchStartTime:0})}function r(){if(!h)return;const d=this;if(k.rect===d)return;p(),k.rect=d;const e=1.1,f=parseFloat(d.getAttribute("x")),g=parseFloat(d.getAttribute("y")),i=parseFloat(d.getAttribute("width")),j=parseFloat(d.getAttribute("height")),l=o(d),m=f+l.x,n=g+l.y,r=m+i/2,s=n+j/2;d.style.transformOrigin=`${f+i/2}px ${g+j/2}px`,d.style.transform=`scale(${e})`,d.style.strokeWidth="4px";const t=q(d);let u=null;if(t){const d=k.rect.getAttribute("data-index")||Date.now(),e=`clip-${d}-${Date.now()}`;k.clipPathId=e;const f=document.createElementNS("http://www.w3.org/2000/svg","clipPath");f.setAttribute("id",e);const g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",m),g.setAttribute("y",n),g.setAttribute("width",i),g.setAttribute("height",j),c.appendChild(f).appendChild(g);const h=document.createElementNS("http://www.w3.org/2000/svg","image");h.setAttribute("href",t.src),h.setAttribute("width",t.width),h.setAttribute("height",t.height),h.setAttribute("class","zoom-part"),h.setAttribute("clip-path",`url(#${e})`);const l=t.group.getAttribute("transform"),o=l?l.match(/translate\(([\d.-]+),([\d.-]+)\)/):null,p=o?parseFloat(o[1]):0,q=o?parseFloat(o[2]):0;h.setAttribute("x",p),h.setAttribute("y",q),h.style.opacity=0,a.appendChild(h),k.zoomPart=h,h.style.transformOrigin=`${r}px ${s}px`,h.style.transform=`scale(${e})`,h.style.opacity=1,u=h}let v=d.nextElementSibling;v&&!v.matches("text.rect-label")&&(v=null);if(v){v.style.opacity="0",k.baseText=v;const a=v.cloneNode(!0),b=d.getAttribute("data-full-text")||v.getAttribute("data-original-text");a.textContent=b,a.removeAttribute("data-original-text");while(a.firstChild){a.removeChild(a.firstChild)}a.textContent=b;const c=parseFloat(v.style.fontSize);a.style.fontSize=c*2+"px",a.style.fill="white",a.style.pointerEvents="none",a.style.userSelect="none",a.style.opacity="1",a.setAttribute("x",m+i/2),a.setAttribute("y",n+c*1.5),a.setAttribute("text-anchor","middle"),k.zoomText=a,document.getElementById("main-svg").appendChild(a)}let w=0;k.animationId=setInterval(()=>{w=(w+10)%360;const a=`drop-shadow(0 0 8px hsl(${w},100%,55%)) drop-shadow(0 0 14px hsl(${(w+60)%360},100%,60%))`;d.style.filter=a,u&&u.style.filter&&(u.style.filter=a),k.zoomText&&k.zoomText.style.filter&&(k.zoomText.style.filter=a)},100)}function s(){if(!h)return;if(k.rect===this)p()}function t(a){const b=a.currentTarget.getAttribute("data-href");b&&b!=="#"&&(window.open(b,"_blank"),a.preventDefault(),a.stopPropagation())}function u(a,b){a.setAttribute("data-index",b);if(!i){function c(){h&&r.call(a)}function d(){h&&s.call(a)}a.addEventListener("mouseover",c),a.addEventListener("mouseout",d)}a.addEventListener("click",t),a.addEventListener("touchstart",function(b){if(!h)return;k.touchStartTime=Date.now(),k.initialScrollLeft=b.scrollLeft,k.isScrolling=!1,r.call(this)}),a.addEventListener("touchend",function(a){if(!h)return;const b=Date.now()-k.touchStartTime;k.isScrolling===!1&&b<j&&t(a),p()})}const v=Array.from(a.querySelectorAll("image")),w=Array.from(a.querySelectorAll("rect.image-mapper-shape")),x=Array.from(a.querySelectorAll("text.rect-label")),y=[...w,...x];function z(a){const b=a.toLowerCase();y.forEach(c=>{let d=!1;if(c.tagName==="rect"){const a=c.getAttribute("data-href")||"";a.toLowerCase().includes(b)&&(d=!0)}else if(c.tagName==="text"){c.textContent.toLowerCase().includes(b)&&(d=!0)}const e=c.tagName==="rect"?c:c.previousElementSibling;if(e&&e.matches("rect.image-mapper-shape")){const c=e.nextElementSibling;if(a.length>0&&!d){e.style.opacity="0.1",e.style.pointerEvents="none",c&&c.style.opacity&&(c.style.opacity="0.1")}else{e.style.opacity="1",e.style.pointerEvents="auto",c&&c.style.opacity&&(c.style.opacity="1"),a.length>0&&d?e.style.filter="drop-shadow(0 0 8px #00FFFF) drop-shadow(0 0 14px #00FFFF)":e.style.filter="none"}}})}const A=l(z,150);g.addEventListener("input",function(){A(this.value)});const B=v.map(a=>a.getAttribute("data-src")||a.getAttribute("href"));let C=0,D=B.length,E=Date.now(),F=1e3;function G(){const a=Math.round(C/D*100);e&&e.textContent&&a>=25&&document.getElementById("bulb-1").classList.add("on"),a>=50&&document.getElementById("bulb-2").classList.add("on"),a>=75&&document.getElementById("bulb-3").classList.add("on"),a===100&&document.getElementById("bulb-4").classList.add("on")}function H(){if(d){const a=Date.now()-E,b=Math.max(0,F-a);setTimeout(()=>{d.style.opacity=0,setTimeout(()=>{d.style.display="none",a.style.opacity=1,setTimeout(()=>{b.scrollLeft=b.scrollWidth,b.scrollTo({left:b.scrollWidth,behavior:"smooth"})},50)},300)},b)}}B.forEach((a,b)=>{const c=new Image;c.onload=c.onerror=()=>{C++,G(),C===D&&H()},c.src=a});function I(a,b,c=5){const d=a.textContent,e=d.split(/\s+/).filter(a=>a.length>0);a.textContent=null;let f=document.createElementNS("http://www.w3.org/2000/svg","tspan");f.setAttribute("x",a.getAttribute("x")),f.setAttribute("dy","0"),a.appendChild(f);let g="";const h=parseFloat(a.style.fontSize)*1.2;let i=0;for(let j=0;j<e.length;j++){const a=e[j],k=g+(g.length?" ":"")+a;f.textContent=k;if(f.getComputedTextLength()>b-c*2&&g.length>0){f.textContent=g,i++,f=document.createElementNS("http://www.w3.org/2000/svg","tspan"),f.setAttribute("x",a.getAttribute("x")),f.setAttribute("dy",`${h}px`),a.appendChild(f),g=a,f.textContent=a}else{g=k}}}document.querySelectorAll("rect.image-mapper-shape").forEach(a=>{const b=a.getAttribute("data-href")||"",c=b.split("/").pop().split("#")[0]||"",d=c.split("."),e=d.slice(0,d.length-1).join("."),f=e.split(/\s+/).filter(a=>a.length>0),g=f.length>0?f[0]:e,h=parseFloat(a.getAttribute("width")),i=parseFloat(a.getAttribute("x")),j=parseFloat(a.getAttribute("y")),k=8,l=16,m=.12;let n=h*m;n=Math.max(k,Math.min(l,n));const o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",i+h/2);const p=j+5;o.setAttribute("y",p),o.setAttribute("text-anchor","middle"),o.textContent=g,o.style.fontSize=n+"px",o.style.fill="white",o.style.pointerEvents="none",o.setAttribute("class","rect-label"),o.setAttribute("data-original-text",e),a.parentNode.insertBefore(o,a.nextSibling),I(o,h)}),document.querySelectorAll("rect.image-mapper-shape").forEach((a,b)=>{a.setAttribute("data-processed","true"),u(a,b)});const J=new MutationObserver(a=>{a.forEach(b=>{b.addedNodes.forEach(c=>{if(c.nodeType===1){if(c.matches("rect.image-mapper-shape")&&!c.hasAttribute("data-processed")){u(c,Date.now()),c.setAttribute("data-processed","true")}if(c.querySelector){c.querySelectorAll("rect.image-mapper-shape:not([data-processed])").forEach(a=>{u(a,Date.now()),a.setAttribute("data-processed","true")})}}})})});J.observe(a,{childList:!0,subtree:!0}),f.addEventListener("change",function(){h=this.checked;const a=document.getElementById("toggle-label");h?a.textContent="Interaction Enabled":a.textContent="Interaction Disabled",h||p()});const K=document.getElementById("move-toggle"),L=document.getElementById("js-toggle-container");K.addEventListener("click",function(){L.classList.contains("top")?(L.classList.remove("top"),L.classList.add("bottom")):(L.classList.remove("bottom"),L.classList.add("top"))})};