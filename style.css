/* ===== 1. الإعدادات العامة ومنع تلاعب المتصفح ===== */
* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent; /* منع الوميض الأزرق في الموبايل */
}

:root {
    color-scheme: only light; /* منع الـ Dark Mode الإجباري في بعض المتصفحات */
    --color-q: #ff4d4d; /* أحمر - أسئلة */
    --color-v: #4da6ff; /* أزرق - فيديو */
    --color-i: #ffffff; /* أبيض - مواد أخرى */
    --color-a: #b366ff; /* بنفسجي - إجابات */
    --color-s: #4dff88; /* أخضر - عملي */
    --color-l: #ffff4d; /* أصفر - محاضرات */
}

html, body {
    margin: 0;
    padding: 0;
    height: 100svh;
    overflow: hidden;
    background: black;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* ===== 2. حاوية الخريطة (SVG Container) ===== */
#scroll-container {
    width: 100vw;
    height: 100svh;
    overflow-x: auto;
    overflow-y: hidden;
    scrollbar-width: thin;
    scrollbar-color: #444 black;
}

#main-svg {
    height: 100%;
    width: auto;
    display: block;
    transition: opacity .3s ease-out;
    opacity: 0; 
    filter: none !important;
}

/* ===== 3. الأشكال التفاعلية (Rectangles) ===== */
.m {
    fill: transparent;
    stroke: transparent;
    stroke-width: 2px;
    transform-origin: center center;
    transition: filter .3s ease, stroke-width .3s ease, transform .3s ease;
    cursor: pointer;
}

.q { stroke: var(--color-q); }
.v { stroke: var(--color-v); }
.i { stroke: var(--color-i); }
.a { stroke: var(--color-a); }
.s { stroke: var(--color-s); }
.l { stroke: var(--color-l); }

/* ===== 4. شاشة التحميل والدليل (Loading & Legend) ===== */
#loading-overlay {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    transition: opacity .5s ease-out;
    color: white;
}

#loading-content {
    text-align: center;
    width: 90%;
    max-width: 400px;
}

#splash-image {
    width: 150px;
    height: auto;
    border-radius: 15px;
    margin-bottom: 20px;
    animation: logo-glow 2s infinite ease-in-out;
}

#loading-content h1 {
    font-size: 1.5rem;
    margin-bottom: 20px;
    opacity: 0.9;
}

/* اللمبات */
#loader-lights {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 30px;
}

.light-bulb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: #222;
    border: 1px solid #444;
    transition: all .4s ease;
}

.light-bulb.on {
    background-color: #ffcc00;
    box-shadow: 0 0 15px #ffcc00, 0 0 30px #ff9900;
}

/* تنسيق دليل الألوان الجديد */
#legend {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    text-align: left;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    color: #ddd;
}

.legend-item::before {
    content: "";
    width: 12px;
    height: 12px;
    border-radius: 3px;
    flex-shrink: 0;
}

/* ربط ألوان الدليل بالمتغيرات */
.legend-item.red::before    { background: var(--color-q); box-shadow: 0 0 5px var(--color-q); }
.legend-item.yellow::before { background: var(--color-l); box-shadow: 0 0 5px var(--color-l); }
.legend-item.white::before  { background: var(--color-i); box-shadow: 0 0 5px var(--color-i); }
.legend-item.purple::before { background: var(--color-a); box-shadow: 0 0 5px var(--color-a); }
.legend-item.green::before  { background: var(--color-s); box-shadow: 0 0 5px var(--color-s); }
.legend-item.blue::before   { background: var(--color-v); box-shadow: 0 0 5px var(--color-v); }

/* ===== 5. صندوق التحكم (UI Container) ===== */
#js-toggle-container {
    position: fixed;
    right: 20px;
    z-index: 10000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    color: white;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 12px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    width: 250px;
    max-width: 85vw;
}

#js-toggle-container.top { top: 20px; }
#js-toggle-container.bottom { bottom: 20px; }

.controls-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

#search-input {
    width: 100%;
    padding: 8px 10px 8px 35px;
    border: 1px solid #444;
    border-radius: 8px;
    background: #111;
    color: white;
    outline: none;
}

/* ===== 6. السويتش (Toggle Switch) ===== */
.switch {
    position: relative;
    width: 40px;
    height: 20px;
}
.switch input { opacity: 0; width: 0; height: 0; }
.slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background-color: #444;
    transition: .4s;
    border-radius: 20px;
}
.slider:before {
    position: absolute;
    content: "";
    height: 14px; width: 14px;
    left: 3px; bottom: 3px;
    background: white;
    transition: .4s;
    border-radius: 50%;
}
input:checked + .slider { background-color: #2196F3; }
input:checked + .slider:before { transform: translateX(20px); }

/* ===== 7. الأنيميشن والتحسينات ===== */
@keyframes logo-glow {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.05); opacity: 1; }
}

@media (max-width: 600px) {
    #js-toggle-container { right: 10px; width: 220px; }
    #legend { grid-template-columns: 1fr; gap: 8px; }
}